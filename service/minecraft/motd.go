package minecraft

import (
	"encoding/json"

	"github.com/yinshaoze/BSProxy/config"
	"github.com/yinshaoze/BSProxy/service/transfer"
	"github.com/yinshaoze/BSProxy/version"

	"github.com/Tnze/go-mc/net/packet"
)

const DefaultMotd = `data:image/png;base64,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`

type motdObject struct {
	Version struct {
		Name     string `json:"name"`
		Protocol int    `json:"protocol"`
	} `json:"version"`
	Players struct {
		Max    int `json:"max"`
		Online int `json:"online"`
		/*		Sample []struct {
				Name string `json:"name"`
				Id   string `json:"id"`
			} `json:"sample"`*/
	} `json:"players"`
	Description struct {
		Text string `json:"text"`
	} `json:"description"`
	Favicon string `json:"favicon"`
}

func generateMotdPacket(protocolVersion int, s *config.ConfigProxyService, options *transfer.Options) packet.Packet {
	online := s.Minecraft.OnlineCount.Online
	if online < 0 {
		online = options.GetCount()
	}
	motd, _ := json.Marshal(motdObject{
		Version: struct {
			Name     string `json:"name"`
			Protocol int    `json:"protocol"`
		}{
			Name:     "BSProxy " + version.Version,
			Protocol: protocolVersion,
		},
		Players: struct {
			Max    int `json:"max"`
			Online int `json:"online"`
		}{
			Max:    s.Minecraft.OnlineCount.Max,
			Online: int(online),
		},
		Description: struct {
			Text string `json:"text"`
		}{
			Text: s.Minecraft.MotdDescription,
		},
		Favicon: s.Minecraft.MotdFavicon,
	})
	return packet.Marshal(
		0x00, // Client bound : Status Response
		packet.String(motd),
	)
}
